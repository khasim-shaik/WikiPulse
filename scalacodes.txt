Before running this scala script: 

Get the following package:
$SPARK_HOME/bin/spark-shell --packages com.databricks:spark-xml_2.11:0.5.0

Part 1: Import the XML file.

import org.apache.spark.sql.SparkSession
import com.databricks.spark.xml._

val spark = SparkSession.builder.getOrCreate()
val df = spark.read
  .option("rowTag", "page")
  .xml("container/parcel.xml")

val selectedColumns= df.select("title","revision")


Part 2: Make the regex pattern:

val pattern = "Category(.*?)[]]".r

#Importing a few things 
import scala.util.matching.Regex
import scala.collection.mutable.ListBuffer

def extractFromRegex (regex: Regex, line:String): Array[String] = {
   val list =  ListBuffer[String]()
   for(m <- regex.findAllIn(line).matchData;
      e <- m.subgroups)
   list+=e
list.toArray
}

var chunk : String = "This is a  long \n string with [[Category: Random ]] and \n [[Category: The 12 times of 12]]"

extractFromRegex(pattern,chunk)



